/* ðŸš€ CRITICAL RESPONSIVE & ACCESSIBILITY FIXES */

/* 1. UNIFIED RESPONSIVE BREAKPOINTS & CSS VARIABLES */
:root {
    --breakpoint-sm: 480px;
    --breakpoint-md: 768px;
    --breakpoint-lg: 1024px;
    --breakpoint-xl: 1200px;

    /* DYNAMIC COLOR SYSTEM VARIABLES */
    --user-primary-h: 248;
    --user-primary-s: 85%;
    --user-primary-l: 63%;

    /* DERIVED COLORS FROM USER SELECTION */
    --primary-500: hsl(var(--user-primary-h), var(--user-primary-s), var(--user-primary-l));
    --primary-400: hsl(var(--user-primary-h), var(--user-primary-s), calc(var(--user-primary-l) + 10%));
    --primary-600: hsl(var(--user-primary-h), var(--user-primary-s), calc(var(--user-primary-l) - 10%));
    --primary-700: hsl(var(--user-primary-h), var(--user-primary-s), calc(var(--user-primary-l) - 20%));
    --primary-300: hsl(var(--user-primary-h), var(--user-primary-s), calc(var(--user-primary-l) + 20%));
    --primary-200: hsl(var(--user-primary-h), var(--user-primary-s), calc(var(--user-primary-l) + 30%));
    --primary-100: hsl(var(--user-primary-h), var(--user-primary-s), calc(var(--user-primary-l) + 40%));

    /* ACCENT COLOR FOR CONSISTENT THEMING */
    --accent-color: var(--primary-500);

    /* Welcome Section Variables - Using dynamic theming */
    --welcome-bg-start: var(--primary-500);
    --welcome-bg-end: var(--primary-700);
    --welcome-text: white;
    --welcome-text-secondary: rgba(255, 255, 255, 0.9);
    --welcome-text-muted: rgba(255, 255, 255, 0.7);
    --welcome-overlay: rgba(255, 255, 255, 0.1);
    --welcome-overlay-hover: rgba(255, 255, 255, 0.15);
    --welcome-border: rgba(255, 255, 255, 0.2);
    --welcome-border-hover: rgba(255, 255, 255, 0.3);
    --welcome-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    --welcome-blur-light: 8px;
    --welcome-transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    --welcome-animation-duration: 6s;
    --welcome-animation-timing: cubic-bezier(0.4, 0, 0.2, 1);
    --welcome-shadow-glow: 0 0 20px rgba(99, 102, 241, 0.3);

    /* Enhanced gradient colors */
    --welcome-accent-1: #8b5cf6;
    --welcome-accent-2: #06b6d4;
    --welcome-accent-3: #10b981;
    --welcome-accent-4: #f59e0b;

    /* Component Base Styles */
    --component-bg: rgba(255, 255, 255, 0.1);
    --component-border: rgba(255, 255, 255, 0.1);
    --component-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    --component-hover-bg: rgba(255, 255, 255, 0.15);
    --component-hover-border: rgba(255, 255, 255, 0.2);
    --component-hover-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);

    /* Colors - Complete color palette */
    --primary-50: #eef2ff;
    --success-50: #f0fdf4;
    --success-100: #dcfce7;
    --success-200: #bbf7d0;
    --success-300: #86efac;
    --success-400: #4ade80;
    --success-500: #22c55e;
    --success-600: #16a34a;
    --success-700: #15803d;

    --warning-50: #fefce8;
    --warning-100: #fef9c3;
    --warning-200: #fef08a;
    --warning-300: #fde047;
    --warning-400: #facc15;
    --warning-500: #eab308;
    --warning-600: #ca8a04;
    --warning-700: #a16207;

    --error-50: #fef2f2;
    --error-100: #fee2e2;
    --error-200: #fecaca;
    --error-300: #fca5a5;
    --error-400: #f87171;
    --error-500: #ef4444;
    --error-600: #dc2626;
    --error-700: #b91c1c;

    --gray-50: #f9fafb;
    --gray-100: #f3f4f6;
    --gray-200: #e5e7eb;
    --gray-300: #d1d5db;
    --gray-400: #9ca3af;
    --gray-500: #6b7280;
    --gray-600: #4b5563;
    --gray-700: #374151;

    /* Backgrounds */
    --bg-base: #ffffff;
    --bg-elevated: #f8fafc;
    --bg-secondary: #f1f5f9;
    --bg-muted: #e2e8f0;
    --bg-hover: #f8fafc;
    --bg-widget: rgba(255, 255, 255, 0.8);
    --bg-overlay: rgba(255, 255, 255, 0.8);
    --bg-tooltip: rgba(0, 0, 0, 0.8);

    /* Text Colors */
    --text-primary: #1e293b;
    --text-secondary: #475569;
    --text-tertiary: #64748b;
    --text-muted: #94a3b8;
    --text-on-primary: #ffffff;
    --text-on-success: #ffffff;
    --text-on-warning: #1e293b;
    --text-on-error: #ffffff;

    /* Border Colors */
    --border-color: #e2e8f0;
    --border-hover: #cbd5e1;
    --border-focus: rgba(99, 102, 241, 0.5);

    /* Spacing */
    --space-1: 0.25rem;
    --space-2: 0.5rem;
    --space-3: 0.75rem;
    --space-4: 1rem;
    --space-5: 1.25rem;
    --space-6: 1.5rem;
    --space-8: 2rem;
    --space-10: 2.5rem;
    --space-12: 3rem;

    /* Border Radius */
    --radius-sm: 0.125rem;
    --radius-md: 0.375rem;
    --radius-lg: 0.5rem;
    --radius-xl: 0.75rem;
    --radius-2xl: 1rem;
    --radius-full: 9999px;

    /* Font Sizes */
    --font-size-xs: 0.75rem;
    --font-size-sm: 0.875rem;
    --font-size-base: 1rem;
    --font-size-lg: 1.125rem;
    --font-size-xl: 1.25rem;
    --font-size-2xl: 1.5rem;
    --font-size-3xl: 1.875rem;
    --font-size-4xl: 2.25rem;
    --font-size-5xl: 3rem;

    /* Shadows */
    --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
    --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
    --shadow-2xl: 0 25px 50px -12px rgb(0 0 0 / 0.25);

    /* Transitions */
    --duration-fast: 0.15s;
    --duration-normal: 0.2s;
    --duration-slow: 0.3s;
    --ease-in-out: cubic-bezier(0.4, 0, 0.2, 1);
    --ease-spring: cubic-bezier(0.87, 0, 0.13, 1);

    /* Consolidated Patterns */
    --gradient-primary: linear-gradient(135deg, var(--primary-500), var(--primary-600));
    --transform-hover: translateY(-2px);

    /* ===== COMPONENT-SPECIFIC ALIASES (Consolidated from multiple files) ===== */

    /* Enhanced Color System Aliases */
    --primary-rgb: 99, 102, 241;
    --accent-rgb: 129, 140, 248;
    --primary-color: var(--primary-500);
    --accent-color: var(--primary-400);
    --success: var(--success-500);
    --warning: var(--warning-500);
    --error: var(--error-500);
    --info: var(--primary-500);
    --hover-light: rgba(99, 102, 241, 0.1);
    --active-light: rgba(99, 102, 241, 0.2);
    --focus-ring: rgba(99, 102, 241, 0.5);

    /* Task System Aliases */
    --task-primary: var(--primary-500);
    --task-success: var(--success-500);
    --task-warning: var(--warning-500);
    --task-error: var(--error-500);
    --task-gradient: var(--gradient-primary);
    --task-success-gradient: linear-gradient(135deg, var(--success-500), var(--success-600));
    --task-warning-gradient: linear-gradient(135deg, var(--warning-500), var(--warning-600));
    --task-error-gradient: linear-gradient(135deg, var(--error-500), var(--error-600));
    --task-glow: rgba(99, 102, 241, 0.3);
    --task-accent-1: var(--welcome-accent-1);
    --task-accent-2: var(--welcome-accent-2);
    --task-accent-3: var(--welcome-accent-3);
    --task-accent-4: var(--welcome-accent-4);

    /* Knowledge Hub Aliases */
    --knowledge-primary: var(--primary-500);
    --knowledge-success: var(--success-500);
    --knowledge-warning: var(--warning-500);
    --knowledge-error: var(--error-500);
    --knowledge-gradient: var(--gradient-primary);
    --knowledge-success-gradient: linear-gradient(135deg, var(--success-500), var(--success-600));
    --knowledge-warning-gradient: linear-gradient(135deg, var(--warning-500), var(--warning-600));
    --knowledge-error-gradient: linear-gradient(135deg, var(--error-500), var(--error-600));
    --knowledge-glow: rgba(99, 102, 241, 0.4);
    --knowledge-accent-1: var(--welcome-accent-1);
    --knowledge-accent-2: var(--welcome-accent-2);
    --knowledge-accent-3: var(--welcome-accent-3);
    --knowledge-accent-4: var(--welcome-accent-4);
    --knowledge-hub-primary: var(--primary-500);
    --knowledge-hub-primary-light: var(--primary-400);
    --knowledge-hub-primary-dark: var(--primary-600);
    --knowledge-section-gap: var(--space-6);
    --knowledge-card-gap: var(--space-4);
    --knowledge-container-padding: var(--space-6);

    /* Company News Aliases */
    --news-primary: var(--primary-500);
    --news-success: var(--success-500);
    --news-warning: var(--warning-500);
    --news-error: var(--error-500);
    --news-gradient: var(--gradient-primary);
    --news-success-gradient: linear-gradient(135deg, var(--success-500), var(--success-600));
    --news-warning-gradient: linear-gradient(135deg, var(--warning-500), var(--warning-600));
    --news-error-gradient: linear-gradient(135deg, var(--error-500), var(--error-600));
    --news-glow: rgba(99, 102, 241, 0.4);
    --news-accent-1: var(--welcome-accent-1);
    --news-accent-2: var(--welcome-accent-2);
    --news-accent-3: var(--welcome-accent-3);
    --news-accent-4: var(--welcome-accent-4);

    /* Live Activity Feed Aliases */
    --activity-primary: var(--primary-500);
    --activity-success: var(--success-500);
    --activity-warning: var(--warning-500);
    --activity-error: var(--error-500);
    --activity-gradient: var(--gradient-primary);
    --activity-success-gradient: linear-gradient(135deg, var(--success-500), var(--success-600));
    --activity-warning-gradient: linear-gradient(135deg, var(--warning-500), var(--warning-600));
    --activity-error-gradient: linear-gradient(135deg, var(--error-500), var(--error-600));
    --activity-glow: rgba(99, 102, 241, 0.4);
    --activity-accent-1: #8b5cf6;
    --activity-accent-2: #06b6d4;
    --activity-accent-3: #10b981;
    --activity-accent-4: #f59e0b;
    --activity-text: white;
    --activity-text-secondary: rgba(255, 255, 255, 0.9);
    --activity-text-muted: rgba(255, 255, 255, 0.7);
    --activity-overlay: rgba(255, 255, 255, 0.1);
    --activity-overlay-hover: rgba(255, 255, 255, 0.15);
    --activity-border: rgba(255, 255, 255, 0.2);
    --activity-border-hover: rgba(255, 255, 255, 0.3);
    --activity-section-gap: var(--space-6);
    --activity-card-gap: var(--space-4);
    --activity-container-padding: var(--space-6);

    /* Smart Insights Aliases */
    --insights-primary: var(--primary-500);
    --insights-success: var(--success-500);
    --insights-warning: var(--warning-500);
    --insights-error: var(--error-500);
    --insights-text: var(--text-primary);
    --insights-text-secondary: var(--text-secondary);
    --insights-text-muted: var(--text-muted);
    --insights-border: var(--border-color);
    --insights-border-hover: var(--border-hover);

    /* Dream Workspace Aliases */
    --workspace-bg-start: #f8fafc;
    --workspace-bg-end: #e2e8f0;
    --workspace-text: #1e293b;
    --workspace-text-secondary: #475569;
    --workspace-text-muted: #64748b;
    --workspace-overlay: rgba(255, 255, 255, 0.1);
    --workspace-overlay-hover: rgba(255, 255, 255, 0.15);
    --workspace-border: rgba(99, 102, 241, 0.2);
    --workspace-border-hover: rgba(99, 102, 241, 0.3);
    --workspace-shadow: var(--shadow-xl);
    --workspace-accent-1: #6366f1;

    /* Task System Component Variables */
    --task-card-bg: var(--bg-elevated);
    --task-card-border: var(--border-color);
    --task-card-hover-border: var(--border-hover);
    --task-card-shadow: var(--shadow-lg);
    --task-card-accent-width: 4px;
    --task-priority-high: var(--error-500);
    --task-priority-medium: var(--warning-500);
    --task-priority-low: var(--primary-500);
    --task-status-completed: var(--success-500);
    --task-status-in-progress: var(--warning-500);
    --task-status-pending: var(--gray-500);
    --task-status-overdue: var(--error-500);
    --task-progress-bg: var(--bg-secondary);
    --task-progress-fill: var(--primary-500);
    --task-progress-height: 8px;

    /* Quick Insights Component Variables */
    --quick-insights-bg: linear-gradient(135deg, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0.08) 100%);
    --quick-insights-hover-bg: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0.1) 100%);
    --quick-insights-border: var(--welcome-border);
    --quick-insights-border-hover: var(--welcome-border-hover);
    --quick-insights-text: var(--welcome-text);
    --quick-insights-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    --quick-insights-blur: blur(15px);
    --quick-insights-card-blur: blur(10px);
}

/* 2. IMPROVED MOBILE GRID SYSTEM */
.dashboard-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1rem;
    padding: 1rem;
}

@media (min-width: 768px) {
    .dashboard-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 1.5rem;
        padding: 1.5rem;
    }
}

@media (min-width: 1024px) {
    .dashboard-grid {
        padding: 2rem;
        gap: 2rem;
    }
}

/* 3. ENHANCED TOUCH TARGETS */
@media (hover: none) and (pointer: coarse) {

    .btn,
    .nav-link,
    .stat-item,
    .event-card,
    .insight-card {
        min-height: 44px !important;
        min-width: 44px !important;
        padding: 12px 16px !important;
    }
}

/* 4. IMPROVED TEXT CONTRAST */
.dashboard-item {
    --text-contrast: rgba(255, 255, 255, 0.95);
}

.dashboard-item h1,
.dashboard-item h2,
.dashboard-item h3,
.dashboard-item p,
.dashboard-item span {
    color: var(--text-contrast) !important;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5) !important;
}

/* 5. HIGH CONTRAST MODE */
@media (prefers-contrast: high) {
    .dashboard-item {
        background: #ffffff !important;
        color: #ffffff !important;
        border: 2px solid #ffffff !important;
    }

    .dashboard-item * {
        color: #ffffff !important;
        text-shadow: none !important;
    }
}

/* 6. REDUCED MOTION */
@media (prefers-reduced-motion: reduce) {

    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.2s !important;
    }
}

/* 7. KEYBOARD NAVIGATION */
*:focus-visible {
    outline: 2px solid var(--primary-500) !important;
    outline-offset: 2px !important;
    box-shadow: 0 0 0 4px hsla(var(--user-primary-h), var(--user-primary-s), var(--user-primary-l), 0.2) !important;
}

/* 8. ENHANCED DARK MODE THEME TOGGLE & LOGO FIXES */
/* Fix theme toggle button background and centering in all modes */
.theme-toggle-btn {
    background: var(--gray-100) !important;
    border: 1px solid var(--gray-300) !important;
    color: var(--gray-700) !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    position: relative !important;
    width: 44px !important;
    height: 44px !important;
    border-radius: 8px !important;
    transition: all 0.2s ease !important;
    cursor: pointer !important;
}

.theme-toggle-btn:hover {
    background: var(--gray-200) !important;
    border-color: var(--gray-400) !important;
    color: var(--gray-900) !important;
    transform: translateY(-1px) !important;
}

[data-theme="dark"] .theme-toggle-btn {
    background: var(--gray-700) !important;
    border-color: var(--gray-600) !important;
    color: var(--gray-300) !important;
}

[data-theme="dark"] .theme-toggle-btn:hover {
    background: var(--gray-600) !important;
    border-color: var(--gray-500) !important;
    color: var(--gray-100) !important;
}

/* Fix toggle button icon centering for both modes */
.theme-toggle-btn svg {
    position: static !important;
    transform: none !important;
    margin: 0 !important;
    padding: 0 !important;
    width: 20px !important;
    height: 20px !important;
}

.theme-toggle-btn .sun-icon,
.theme-toggle-btn .moon-icon {
    position: absolute !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    margin: 0 !important;
    padding: 0 !important;
}

/* Fix toggle switch circle color in dark mode */
[data-theme="dark"] .theme-toggle::before {
    background: var(--gray-200) !important;
}

[data-theme="dark"] .theme-toggle.active::before {
    background: var(--gray-100) !important;
}

/* COMPREHENSIVE LOGO FIXES FOR DARK MODE */
/* Fix logo text readability in all themes */
.logo-text {
    font-weight: 700 !important;
    font-size: var(--font-size-xl) !important;
    transition: color 0.2s ease !important;
}

/* Light mode logo styling - gradient text */
html:not([data-theme="dark"]) .logo-text,
[data-theme="light"] .logo-text {
    background: linear-gradient(135deg, var(--primary-600), var(--primary-700)) !important;
    -webkit-background-clip: text !important;
    -webkit-text-fill-color: transparent !important;
    background-clip: text !important;
    color: transparent !important;
}

/* Dark mode logo - solid white color for better readability */
[data-theme="dark"] .logo-text {
    background: none !important;
    -webkit-background-clip: unset !important;
    -webkit-text-fill-color: unset !important;
    background-clip: unset !important;
    color: rgba(255, 255, 255, 0.98) !important;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.4) !important;
}

/* Logo icon updates for better visibility */
.logo-icon {
    background: var(--primary-500) !important;
    color: white !important;
    border-radius: var(--radius-xl) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
    transition: all 0.2s ease !important;
}

[data-theme="dark"] .logo-icon {
    background: var(--primary-500) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4) !important;
}

/* Logo hover effects */
.logo:hover .logo-icon {
    transform: rotate(5deg) scale(1.1) !important;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2) !important;
}

[data-theme="dark"] .logo:hover .logo-icon {
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5) !important;
}

/* 9. COMPREHENSIVE DARK MODE BACKGROUND FIXES */
/* Fix main component backgrounds in dark mode */
[data-theme="dark"] .dashboard-item,
[data-theme="dark"] .welcome-section,
[data-theme="dark"] .card,
[data-theme="dark"] .widget,
[data-theme="dark"] .panel,
[data-theme="dark"] .component,
[data-theme="dark"] .section {
    background: rgba(31, 41, 55, 0.8) !important;
    /* dark gray with transparency */
    backdrop-filter: blur(10px) !important;
    border-color: rgba(75, 85, 99, 0.5) !important;
}

/* Fix specific component backgrounds that stay white */
[data-theme="dark"] .analytics-dashboard,
[data-theme="dark"] .stats-grid,
[data-theme="dark"] .kpi-dashboard,
[data-theme="dark"] .goals-dashboard,
[data-theme="dark"] .insights-panel,
[data-theme="dark"] .activity-feed,
[data-theme="dark"] .task-card,
[data-theme="dark"] .event-card {
    background: rgba(31, 41, 55, 0.9) !important;
    color: rgba(243, 244, 246, 0.95) !important;
}

/* Fix any remaining white backgrounds */
[data-theme="dark"] *[style*="background: white"],
[data-theme="dark"] *[style*="background: #fff"],
[data-theme="dark"] *[style*="background: #ffffff"],
[data-theme="dark"] *[style*="background-color: white"],
[data-theme="dark"] *[style*="background-color: #fff"],
[data-theme="dark"] *[style*="background-color: #ffffff"] {
    background: rgba(31, 41, 55, 0.8) !important;
    color: rgba(243, 244, 246, 0.95) !important;
}

/* Fix main dashboard and body backgrounds */
[data-theme="dark"] body,
[data-theme="dark"] .dashboard,
[data-theme="dark"] .main-content {
    background: rgb(17, 24, 39) !important;
    /* darker base background */
}

/* Fix welcome section specific backgrounds */
[data-theme="dark"] .welcome-section {
    background: linear-gradient(135deg, rgba(31, 41, 55, 0.9) 0%, rgba(17, 24, 39, 0.9) 100%) !important;
}

/* Fix any gradients that include white */
[data-theme="dark"] *[style*="linear-gradient"][style*="white"],
[data-theme="dark"] *[style*="linear-gradient"][style*="#fff"] {
    background: linear-gradient(135deg, rgba(31, 41, 55, 0.9) 0%, rgba(17, 24, 39, 0.9) 100%) !important;
}

/* 10. DEEP NESTED ELEMENT DARK MODE FIXES */
/* Fix all nested white backgrounds inside components */
[data-theme="dark"] .dashboard-item *,
[data-theme="dark"] .welcome-section *,
[data-theme="dark"] .card *,
[data-theme="dark"] .widget *,
[data-theme="dark"] .component * {
    background-color: transparent !important;
}

/* Fix specific nested elements that commonly stay white */
[data-theme="dark"] .btn,
[data-theme="dark"] .button,
[data-theme="dark"] .action-btn,
[data-theme="dark"] .quick-action,
[data-theme="dark"] .status-indicator,
[data-theme="dark"] .badge,
[data-theme="dark"] .tag,
[data-theme="dark"] .chip {
    background: rgba(55, 65, 81, 0.8) !important;
    color: rgba(243, 244, 246, 0.95) !important;
    border-color: rgba(75, 85, 99, 0.5) !important;
}

/* Fix input fields and form elements */
[data-theme="dark"] input,
[data-theme="dark"] textarea,
[data-theme="dark"] select,
[data-theme="dark"] .form-control,
[data-theme="dark"] .input-field {
    background: rgba(31, 41, 55, 0.9) !important;
    color: rgba(243, 244, 246, 0.95) !important;
    border-color: rgba(75, 85, 99, 0.5) !important;
}

/* Fix dropdown and modal backgrounds */
[data-theme="dark"] .dropdown,
[data-theme="dark"] .modal,
[data-theme="dark"] .popup,
[data-theme="dark"] .overlay,
[data-theme="dark"] .tooltip {
    background: rgba(31, 41, 55, 0.95) !important;
    color: rgba(243, 244, 246, 0.95) !important;
    border-color: rgba(75, 85, 99, 0.5) !important;
}

/* Fix any remaining white backgrounds with higher specificity */
[data-theme="dark"] div[style*="background"],
[data-theme="dark"] span[style*="background"],
[data-theme="dark"] section[style*="background"],
[data-theme="dark"] article[style*="background"] {
    background: rgba(31, 41, 55, 0.8) !important;
}

/* Universal fallback for stubborn white backgrounds */
[data-theme="dark"] *[style*="background: rgb(255, 255, 255)"],
[data-theme="dark"] *[style*="background-color: rgb(255, 255, 255)"],
[data-theme="dark"] *[class*="bg-white"],
[data-theme="dark"] *[class*="background-white"] {
    background: rgba(31, 41, 55, 0.8) !important;
    color: rgba(243, 244, 246, 0.95) !important;
}

/* Fix any tables or grid elements */
[data-theme="dark"] table,
[data-theme="dark"] .table,
[data-theme="dark"] .grid,
[data-theme="dark"] .list-item,
[data-theme="dark"] .row,
[data-theme="dark"] .column {
    background: transparent !important;
    color: rgba(243, 244, 246, 0.95) !important;
}

/* Fix specific UI elements that might have white backgrounds */
[data-theme="dark"] .stat-value,
[data-theme="dark"] .metric,
[data-theme="dark"] .counter,
[data-theme="dark"] .progress-bar,
[data-theme="dark"] .indicator,
[data-theme="dark"] .avatar,
[data-theme="dark"] .icon-wrapper {
    background: rgba(55, 65, 81, 0.6) !important;
    color: rgba(243, 244, 246, 0.95) !important;
}

/* 11. NUCLEAR DARK MODE OVERRIDE - MAXIMUM SPECIFICITY */
/* This is the most aggressive approach to eliminate ALL white backgrounds */

/* Catch ALL possible white background patterns */
html[data-theme="dark"] body * {
    background-color: transparent !important;
}

html[data-theme="dark"] body *[style],
html[data-theme="dark"] body div,
html[data-theme="dark"] body section,
html[data-theme="dark"] body article,
html[data-theme="dark"] body span,
html[data-theme="dark"] body p,
html[data-theme="dark"] body h1,
html[data-theme="dark"] body h2,
html[data-theme="dark"] body h3,
html[data-theme="dark"] body h4,
html[data-theme="dark"] body h5,
html[data-theme="dark"] body h6 {
    background: transparent !important;
}

/* Nuclear override for ANY remaining white */
html[data-theme="dark"] * {
    background-image: none !important;
}

html[data-theme="dark"] *:not(.dashboard):not(body):not(html) {
    background-color: transparent !important;
}

/* Target specific problem elements with maximum specificity */
html[data-theme="dark"] body .dashboard-item,
html[data-theme="dark"] body .card,
html[data-theme="dark"] body .component,
html[data-theme="dark"] body .widget,
html[data-theme="dark"] body .panel {
    background: rgba(31, 41, 55, 0.8) !important;
    background-color: rgba(31, 41, 55, 0.8) !important;
    background-image: none !important;
}

/* Override any CSS that sets white backgrounds */
html[data-theme="dark"] body *[class*="white"],
html[data-theme="dark"] body *[class*="light"],
html[data-theme="dark"] body *[class*="bg-"],
html[data-theme="dark"] body *[style*="255"] {
    background: rgba(31, 41, 55, 0.8) !important;
    background-color: rgba(31, 41, 55, 0.8) !important;
}

/* Final nuclear option - override EVERYTHING */
html[data-theme="dark"] body .dashboard * {
    background: transparent !important;
}

html[data-theme="dark"] body .dashboard .dashboard-item {
    background: rgba(31, 41, 55, 0.8) !important;
}

html[data-theme="dark"] body .dashboard .welcome-section {
    background: linear-gradient(135deg, rgba(31, 41, 55, 0.9) 0%, rgba(17, 24, 39, 0.9) 100%) !important;
}

/* 12. COMPREHENSIVE DARK MODE COLOR FIXES */
/* Fix all text colors for proper dark mode visibility */
[data-theme="dark"] *,
[data-theme="dark"] h1,
[data-theme="dark"] h2,
[data-theme="dark"] h3,
[data-theme="dark"] h4,
[data-theme="dark"] h5,
[data-theme="dark"] h6,
[data-theme="dark"] p,
[data-theme="dark"] span,
[data-theme="dark"] div,
[data-theme="dark"] label,
[data-theme="dark"] a {
    color: rgba(243, 244, 246, 0.95) !important;
}

/* Fix specific text elements that might stay dark */
[data-theme="dark"] .text-primary,
[data-theme="dark"] .text-secondary,
[data-theme="dark"] .text-muted,
[data-theme="dark"] .title,
[data-theme="dark"] .subtitle,
[data-theme="dark"] .description,
[data-theme="dark"] .label,
[data-theme="dark"] .caption {
    color: rgba(243, 244, 246, 0.95) !important;
}

/* Fix headings and important text */
[data-theme="dark"] .welcome-title,
[data-theme="dark"] .section-title,
[data-theme="dark"] .card-title,
[data-theme="dark"] .widget-title {
    color: rgba(255, 255, 255, 0.98) !important;
}

/* Fix borders for dark mode */
[data-theme="dark"] *,
[data-theme="dark"] .dashboard-item,
[data-theme="dark"] .card,
[data-theme="dark"] .widget,
[data-theme="dark"] .component {
    border-color: rgba(75, 85, 99, 0.5) !important;
}

/* Fix button and interactive element colors */
[data-theme="dark"] .btn,
[data-theme="dark"] .button,
[data-theme="dark"] button {
    background: rgba(55, 65, 81, 0.8) !important;
    color: rgba(243, 244, 246, 0.95) !important;
    border-color: rgba(75, 85, 99, 0.6) !important;
}

[data-theme="dark"] .btn:hover,
[data-theme="dark"] .button:hover,
[data-theme="dark"] button:hover {
    background: rgba(75, 85, 99, 0.9) !important;
    color: rgba(255, 255, 255, 0.98) !important;
}

/* Fix primary buttons */
[data-theme="dark"] .btn-primary,
[data-theme="dark"] .btn.primary {
    background: rgba(99, 102, 241, 0.8) !important;
    color: rgba(255, 255, 255, 0.98) !important;
}

/* Fix links */
[data-theme="dark"] a,
[data-theme="dark"] .link {
    color: rgba(147, 197, 253, 0.9) !important;
}

[data-theme="dark"] a:hover,
[data-theme="dark"] .link:hover {
    color: rgba(191, 219, 254, 0.95) !important;
}

/* Fix icons and SVGs */
[data-theme="dark"] svg,
[data-theme="dark"] .icon {
    fill: rgba(209, 213, 219, 0.8) !important;
    color: rgba(209, 213, 219, 0.8) !important;
}

/* Fix form elements */
[data-theme="dark"] input::placeholder,
[data-theme="dark"] textarea::placeholder {
    color: rgba(156, 163, 175, 0.7) !important;
}

/* Fix stats and metrics */
[data-theme="dark"] .stat-value,
[data-theme="dark"] .metric-value,
[data-theme="dark"] .number,
[data-theme="dark"] .count {
    color: rgba(255, 255, 255, 0.98) !important;
    font-weight: 600 !important;
}

/* Fix secondary text */
[data-theme="dark"] .text-sm,
[data-theme="dark"] .small,
[data-theme="dark"] .subtitle,
[data-theme="dark"] .description {
    color: rgba(209, 213, 219, 0.8) !important;
}

/* Fix status indicators */
[data-theme="dark"] .status-online,
[data-theme="dark"] .status-active {
    color: rgba(34, 197, 94, 0.9) !important;
}

[data-theme="dark"] .status-offline,
[data-theme="dark"] .status-inactive {
    color: rgba(239, 68, 68, 0.9) !important;
}

[data-theme="dark"] .status-warning {
    color: rgba(245, 158, 11, 0.9) !important;
}

/* Fix any remaining dark text on dark backgrounds */
[data-theme="dark"] *[style*="color: black"],
[data-theme="dark"] *[style*="color: #000"],
[data-theme="dark"] *[style*="color: rgb(0"],
[data-theme="dark"] .text-black,
[data-theme="dark"] .text-dark {
    color: rgba(243, 244, 246, 0.95) !important;
}

/* Fix box shadows for dark mode */
[data-theme="dark"] *,
[data-theme="dark"] .card,
[data-theme="dark"] .widget,
[data-theme="dark"] .component {
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2) !important;
}

/* Fix hover states */
[data-theme="dark"] .dashboard-item:hover,
[data-theme="dark"] .card:hover,
[data-theme="dark"] .widget:hover {
    background: rgba(55, 65, 81, 0.9) !important;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.4), 0 4px 6px -2px rgba(0, 0, 0, 0.3) !important;
}

/* 13. UNIFIED COMPONENT STYLING - LIGHT & DARK MODE CONSISTENCY */
/* Ensure all components have identical styling patterns */

/* LIGHT MODE - Base Component Styling */
.dashboard-item,
.card,
.widget,
.panel,
.component,
.section {
    background: rgba(255, 255, 255, 0.9) !important;
    backdrop-filter: blur(10px) !important;
    border: 1px solid rgba(0, 0, 0, 0.1) !important;
    border-radius: 12px !important;
    padding: 1.5rem !important;
    margin-bottom: 1rem !important;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06) !important;
}

/* WELCOME SECTION - Keep original beautiful gradient */
.welcome-section {
    /* Don't override the welcome section background - preserve original gradient */
    border: 1px solid rgba(0, 0, 0, 0.1) !important;
    border-radius: 12px !important;
    padding: 1.5rem !important;
    margin-bottom: 1rem !important;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06) !important;
}

/* LIGHT MODE - Component Hover States */
.dashboard-item:hover,
.card:hover,
.widget:hover,
.component:hover {
    background: rgba(255, 255, 255, 0.95) !important;
    transform: translateY(-2px) !important;
    box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04) !important;
}

/* WELCOME SECTION - Preserve original hover effect */
.welcome-section:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04) !important;
}

/* LIGHT MODE - Text Consistency */
.dashboard-item *,
.welcome-section *,
.card *,
.widget *,
.component * {
    color: rgba(31, 41, 55, 0.9) !important;
}

/* LIGHT MODE - Headings */
.dashboard-item h1,
.dashboard-item h2,
.dashboard-item h3,
.card h1,
.card h2,
.card h3,
.widget h1,
.widget h2,
.widget h3 {
    color: rgba(17, 24, 39, 0.95) !important;
    font-weight: 600 !important;
    margin-bottom: 0.5rem !important;
}

/* LIGHT MODE - Secondary Text */
.dashboard-item .subtitle,
.dashboard-item .description,
.dashboard-item .text-sm,
.card .subtitle,
.card .description,
.widget .subtitle,
.widget .description {
    color: rgba(75, 85, 99, 0.8) !important;
}

/* LIGHT MODE - Interactive Elements */
.dashboard-item .btn,
.dashboard-item button,
.card .btn,
.card button,
.widget .btn,
.widget button {
    background: rgba(99, 102, 241, 0.9) !important;
    color: white !important;
    border: 1px solid rgba(99, 102, 241, 0.9) !important;
    border-radius: 8px !important;
    padding: 0.5rem 1rem !important;
    transition: all 0.2s ease !important;
}

.dashboard-item .btn:hover,
.dashboard-item button:hover,
.card .btn:hover,
.card button:hover,
.widget .btn:hover,
.widget button:hover {
    background: rgba(79, 70, 229, 0.95) !important;
    transform: translateY(-1px) !important;
}

/* DARK MODE - Enhanced Component Consistency */
[data-theme="dark"] .dashboard-item,
[data-theme="dark"] .card,
[data-theme="dark"] .widget,
[data-theme="dark"] .panel,
[data-theme="dark"] .component,
[data-theme="dark"] .section {
    background: rgba(31, 41, 55, 0.9) !important;
    backdrop-filter: blur(10px) !important;
    border: 1px solid rgba(75, 85, 99, 0.4) !important;
    border-radius: 12px !important;
    padding: 1.5rem !important;
    margin-bottom: 1rem !important;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2) !important;
}

/* DARK MODE - Welcome section with dark overlay to maintain readability */
[data-theme="dark"] .welcome-section {
    /* Keep original gradient but add dark overlay for readability */
    position: relative !important;
    border: 1px solid rgba(75, 85, 99, 0.4) !important;
    border-radius: 12px !important;
    padding: 1.5rem !important;
    margin-bottom: 1rem !important;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2) !important;
}

[data-theme="dark"] .welcome-section::before {
    content: '' !important;
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    background: rgba(17, 24, 39, 0.4) !important;
    border-radius: 12px !important;
    z-index: 1 !important;
    pointer-events: none !important;
}

[data-theme="dark"] .welcome-section>* {
    position: relative !important;
    z-index: 2 !important;
}

/* DARK MODE - Component Hover States */
[data-theme="dark"] .dashboard-item:hover,
[data-theme="dark"] .card:hover,
[data-theme="dark"] .widget:hover,
[data-theme="dark"] .component:hover {
    background: rgba(55, 65, 81, 0.9) !important;
    transform: translateY(-2px) !important;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.4), 0 4px 6px -2px rgba(0, 0, 0, 0.3) !important;
}

/* DARK MODE - Welcome section hover preserves gradient */
[data-theme="dark"] .welcome-section:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.4), 0 4px 6px -2px rgba(0, 0, 0, 0.3) !important;
}

/* DARK MODE - Text Consistency */
[data-theme="dark"] .dashboard-item *,
[data-theme="dark"] .welcome-section *,
[data-theme="dark"] .card *,
[data-theme="dark"] .widget *,
[data-theme="dark"] .component * {
    color: rgba(243, 244, 246, 0.95) !important;
}

/* DARK MODE - Headings */
[data-theme="dark"] .dashboard-item h1,
[data-theme="dark"] .dashboard-item h2,
[data-theme="dark"] .dashboard-item h3,
[data-theme="dark"] .card h1,
[data-theme="dark"] .card h2,
[data-theme="dark"] .card h3,
[data-theme="dark"] .widget h1,
[data-theme="dark"] .widget h2,
[data-theme="dark"] .widget h3 {
    color: rgba(255, 255, 255, 0.98) !important;
    font-weight: 600 !important;
    margin-bottom: 0.5rem !important;
}

/* DARK MODE - Secondary Text */
[data-theme="dark"] .dashboard-item .subtitle,
[data-theme="dark"] .dashboard-item .description,
[data-theme="dark"] .dashboard-item .text-sm,
[data-theme="dark"] .card .subtitle,
[data-theme="dark"] .card .description,
[data-theme="dark"] .widget .subtitle,
[data-theme="dark"] .widget .description {
    color: rgba(209, 213, 219, 0.8) !important;
}

/* DARK MODE - Interactive Elements */
[data-theme="dark"] .dashboard-item .btn,
[data-theme="dark"] .dashboard-item button,
[data-theme="dark"] .card .btn,
[data-theme="dark"] .card button,
[data-theme="dark"] .widget .btn,
[data-theme="dark"] .widget button {
    background: rgba(99, 102, 241, 0.8) !important;
    color: rgba(255, 255, 255, 0.98) !important;
    border: 1px solid rgba(129, 140, 248, 0.5) !important;
    border-radius: 8px !important;
    padding: 0.5rem 1rem !important;
    transition: all 0.2s ease !important;
}

[data-theme="dark"] .dashboard-item .btn:hover,
[data-theme="dark"] .dashboard-item button:hover,
[data-theme="dark"] .card .btn:hover,
[data-theme="dark"] .card button:hover,
[data-theme="dark"] .widget .btn:hover,
[data-theme="dark"] .widget button:hover {
    background: rgba(129, 140, 248, 0.9) !important;
    transform: translateY(-1px) !important;
}

/* 15. COMPREHENSIVE PURPLE COLOR OVERRIDE SYSTEM */
/* Override ALL hardcoded purple colors to use dynamic theming */

/* Override all hardcoded #6366f1 (indigo-500) references */
*[style*="#6366f1"],
*[style*="rgb(99, 102, 241)"],
.bg-indigo-500,
.text-indigo-500,
.border-indigo-500 {
    background-color: var(--primary-500) !important;
    color: var(--primary-500) !important;
    border-color: var(--primary-500) !important;
}

/* Override all hardcoded #4f46e5 (indigo-600) references */
*[style*="#4f46e5"],
*[style*="rgb(79, 70, 229)"],
.bg-indigo-600,
.text-indigo-600,
.border-indigo-600 {
    background-color: var(--primary-600) !important;
    color: var(--primary-600) !important;
    border-color: var(--primary-600) !important;
}

/* Override all hardcoded #4338ca (indigo-700) references */
*[style*="#4338ca"],
*[style*="rgb(67, 56, 202)"],
.bg-indigo-700,
.text-indigo-700,
.border-indigo-700 {
    background-color: var(--primary-700) !important;
    color: var(--primary-700) !important;
    border-color: var(--primary-700) !important;
}

/* Override welcome section gradient that uses hardcoded purple */
.welcome-section {
    background: linear-gradient(135deg, var(--primary-500) 0%, var(--primary-600) 50%, var(--primary-700) 100%) !important;
}

/* Override button colors to use dynamic theming */
.btn-primary,
.button-primary,
button[class*="primary"],
.primary-button {
    background: var(--primary-500) !important;
    border-color: var(--primary-500) !important;
    color: white !important;
}

.btn-primary:hover,
.button-primary:hover,
button[class*="primary"]:hover,
.primary-button:hover {
    background: var(--primary-600) !important;
    border-color: var(--primary-600) !important;
}

/* Override link colors */
a,
.link,
.text-link {
    color: var(--primary-500) !important;
}

a:hover,
.link:hover,
.text-link:hover {
    color: var(--primary-600) !important;
}

[data-theme="dark"] a,
[data-theme="dark"] .link,
[data-theme="dark"] .text-link {
    color: var(--primary-400) !important;
}

[data-theme="dark"] a:hover,
[data-theme="dark"] .link:hover,
[data-theme="dark"] .text-link:hover {
    color: var(--primary-300) !important;
}

/* Override focus states */
*:focus-visible,
.focus-visible {
    outline-color: var(--primary-500) !important;
    box-shadow: 0 0 0 4px hsla(var(--user-primary-h), var(--user-primary-s), var(--user-primary-l), 0.2) !important;
}

/* Override progress bars and indicators */
.progress-bar,
.indicator,
.status-active {
    background: var(--primary-500) !important;
}

/* Override badges and tags */
.badge-primary,
.tag-primary {
    background: var(--primary-500) !important;
    color: white !important;
}

/* 16. LAYOUT STABILITY FIXES - PREVENT SHIFTING */
/* Ensure consistent layout positioning */
html,
body {
    overflow-x: hidden !important;
    position: relative !important;
    width: 100% !important;
    max-width: 100vw !important;
}

/* Prevent horizontal scrolling and layout shifts */
* {
    box-sizing: border-box !important;
}

/* Ensure main container doesn't shift */
.dashboard,
.main-container,
.content-area {
    width: 100% !important;
    max-width: 100% !important;
    position: relative !important;
    overflow-x: hidden !important;
}

/* Fix potential sidebar layout issues - reduced conflicts with sidebar.css */
.sidebar {
    flex-shrink: 0;
    /* Position and height handled in sidebar.css to avoid conflicts */
    overflow-y: auto;
    overflow-x: hidden;
}

/* Ensure header stays fixed and doesn't cause shifts */
.header {
    position: sticky !important;
    top: 0 !important;
    z-index: 50 !important;
    width: 100% !important;
    max-width: 100% !important;
    left: 0 !important;
    right: 0 !important;
}

/* Fix main content area to prevent shifting */
.main-content {
    flex: 1 !important;
    min-width: 0 !important;
    overflow-x: hidden !important;
    position: relative !important;
}

/* Dashboard grid stability */
.dashboard-grid {
    display: grid !important;
    width: 100% !important;
    max-width: 100% !important;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)) !important;
    gap: 1rem !important;
    padding: 1rem !important;
    box-sizing: border-box !important;
}

/* Prevent component overflow */
.dashboard-item,
.card,
.widget,
.component {
    min-width: 0 !important;
    max-width: 100% !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    position: relative !important;
}

/* Fix any absolute positioned elements that might cause shifts */
.absolute,
[style*="position: absolute"] {
    position: absolute !important;
    z-index: auto !important;
}

/* Ensure modals and overlays don't affect layout */
.modal,
.overlay,
.popup {
    position: fixed !important;
    z-index: 1000 !important;
    top: 0 !important;
    left: 0 !important;
    width: 100vw !important;
    height: 100vh !important;
}

/* Fix any elements with transform that might cause shifts */
.transform-none {
    transform: none !important;
}

/* 18. SIDEBAR BACKGROUND FIXES */
/* Ensure sidebar uses proper background colors in all modes */

/* Light mode sidebar - should be light */
.sidebar {
    background: var(--bg-elevated) !important;
    border-right-color: var(--border-color) !important;
}

/* Force light mode sidebar background to be light */
html:not([data-theme="dark"]) .sidebar,
[data-theme="light"] .sidebar,
.sidebar:not([data-theme="dark"]),
body:not([data-theme="dark"]) .sidebar,
html[data-theme="light"] .sidebar,
body[data-theme="light"] .sidebar {
    background: white !important;
    background-color: white !important;
    background-image: none !important;
    border-right-color: #e2e8f0 !important;
    --bg-elevated: white !important;
}

/* Dark mode sidebar - should be dark */
[data-theme="dark"] .sidebar {
    background: #1e293b !important;
    background-color: #1e293b !important;
    border-right-color: #334155 !important;
}

/* Sidebar header and content fixes */
.sidebar-header,
.sidebar-content,
.sidebar-nav,
.nav-item {
    background: transparent !important;
    background-color: transparent !important;
}

/* Navigation link fixes */
.nav-link {
    color: var(--text-primary) !important;
    transition: all 0.2s ease !important;
    background: transparent !important;
}

.nav-link:hover {
    background: var(--bg-hover) !important;
    color: var(--primary-500) !important;
}

[data-theme="dark"] .nav-link {
    color: rgba(243, 244, 246, 0.9) !important;
}

[data-theme="dark"] .nav-link:hover {
    background: rgba(55, 65, 81, 0.6) !important;
    color: var(--primary-400) !important;
}

/* Extra specificity for stubborn elements */
html:not([data-theme="dark"]) .sidebar *:not(.btn):not(.nav-link:hover),
[data-theme="light"] .sidebar *:not(.btn):not(.nav-link:hover) {
    background-color: transparent !important;
}

/* Ultimate sidebar light mode override */
:root:not([data-theme="dark"]) .sidebar,
html:not([data-theme="dark"]) body .sidebar,
body:not([data-theme="dark"]) .sidebar {
    background: #ffffff !important;
    background-color: #ffffff !important;
    background-image: none !important;
    --bg-elevated: #ffffff !important;
}

/* Force all sidebar children to have transparent backgrounds in light mode */
html:not([data-theme="dark"]) .sidebar,
html:not([data-theme="dark"]) .sidebar *,
[data-theme="light"] .sidebar,
[data-theme="light"] .sidebar * {
    background-color: transparent !important;
}

/* But set the sidebar itself to white */
html:not([data-theme="dark"]) .sidebar,
[data-theme="light"] .sidebar {
    background-color: #ffffff !important;
    background: #ffffff !important;
}

/* Sidebar toggle button colors - handled in sidebar.css to avoid conflicts */

/* Active navigation state */
.nav-link.active {
    background: var(--primary-50) !important;
    color: var(--primary-600) !important;
    border-right: 3px solid var(--primary-500) !important;
}

[data-theme="dark"] .nav-link.active {
    background: rgba(99, 102, 241, 0.1) !important;
    color: var(--primary-400) !important;
    border-right-color: var(--primary-500) !important;
}

/* 19. COLOR PICKER BUTTON FIXES */
/* Ensure color picker toggle button works in both modes */
.color-picker-menu .action-button,
#toggleColorPicker {
    background: var(--bg-elevated) !important;
    border: 1px solid var(--border-color) !important;
    color: var(--text-primary) !important;
    border-radius: 8px !important;
    padding: 8px 12px !important;
    transition: all 0.2s ease !important;
    cursor: pointer !important;
}

.color-picker-menu .action-button:hover,
#toggleColorPicker:hover {
    background: var(--bg-hover) !important;
    border-color: var(--primary-400) !important;
    color: var(--primary-500) !important;
    transform: translateY(-1px) !important;
}

[data-theme="dark"] .color-picker-menu .action-button,
[data-theme="dark"] #toggleColorPicker {
    background: rgba(55, 65, 81, 0.8) !important;
    border-color: rgba(75, 85, 99, 0.6) !important;
    color: rgba(255, 255, 255, 0.9) !important;
}

[data-theme="dark"] .color-picker-menu .action-button:hover,
[data-theme="dark"] #toggleColorPicker:hover {
    background: rgba(75, 85, 99, 0.9) !important;
    border-color: var(--primary-400) !important;
    color: var(--primary-400) !important;
}

/* Color picker icon styling */
.color-picker-menu svg,
#toggleColorPicker svg {
    width: 20px !important;
    height: 20px !important;
    fill: currentColor !important;
    stroke: currentColor !important;
}

/* 17. ENHANCED TEXT READABILITY - ALL MODES & THEMES */
/* Ensure text is readable regardless of background or theme */

/* High contrast text for critical elements */
.stat-value,
.metric-value,
.number,
.count,
.title,
.heading,
.welcome-title,
.section-title {
    font-weight: 600 !important;
    font-size: 1.1em !important;
    color: var(--text-primary) !important;
}

[data-theme="dark"] .stat-value,
[data-theme="dark"] .metric-value,
[data-theme="dark"] .number,
[data-theme="dark"] .count,
[data-theme="dark"] .title,
[data-theme="dark"] .heading,
[data-theme="dark"] .welcome-title,
[data-theme="dark"] .section-title {
    color: rgba(255, 255, 255, 0.98) !important;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3) !important;
}

/* Links visibility with dynamic theming */
a,
.link,
.text-link {
    color: var(--primary-500) !important;
    text-decoration: none !important;
    transition: color 0.2s ease !important;
}

/* Duplicate link hover and dark theme rules removed - already defined above */

/* Form elements with theme consistency */
input,
textarea,
select,
.form-control,
.input-field {
    background: rgba(255, 255, 255, 0.9) !important;
    color: var(--text-primary) !important;
    border: 1px solid var(--border-color) !important;
    border-radius: 8px !important;
    padding: 0.75rem 1rem !important;
    transition: all 0.2s ease !important;
}

input:focus,
textarea:focus,
select:focus,
.form-control:focus,
.input-field:focus {
    border-color: var(--primary-500) !important;
    box-shadow: 0 0 0 3px hsla(var(--user-primary-h), var(--user-primary-s), var(--user-primary-l), 0.2) !important;
}

[data-theme="dark"] input,
[data-theme="dark"] textarea,
[data-theme="dark"] select,
[data-theme="dark"] .form-control,
[data-theme="dark"] .input-field {
    background: rgba(31, 41, 55, 0.9) !important;
    color: rgba(243, 244, 246, 0.95) !important;
    border: 1px solid rgba(75, 85, 99, 0.5) !important;
}

/* Status indicators with enhanced visibility */
.status-indicator,
.badge,
.tag {
    padding: 0.25rem 0.75rem !important;
    border-radius: 9999px !important;
    font-size: 0.875rem !important;
    font-weight: 500 !important;
}

.status-online,
.status-success,
.status-active {
    background: rgba(34, 197, 94, 0.15) !important;
    color: rgba(22, 163, 74, 0.9) !important;
    border: 1px solid rgba(34, 197, 94, 0.3) !important;
}

.status-warning {
    background: rgba(245, 158, 11, 0.15) !important;
    color: rgba(217, 119, 6, 0.9) !important;
    border: 1px solid rgba(245, 158, 11, 0.3) !important;
}

.status-error,
.status-offline {
    background: rgba(239, 68, 68, 0.15) !important;
    color: rgba(220, 38, 38, 0.9) !important;
    border: 1px solid rgba(239, 68, 68, 0.3) !important;
}

[data-theme="dark"] .status-online,
[data-theme="dark"] .status-success,
[data-theme="dark"] .status-active {
    background: rgba(34, 197, 94, 0.25) !important;
    color: rgba(74, 222, 128, 0.95) !important;
    border: 1px solid rgba(74, 222, 128, 0.4) !important;
}

[data-theme="dark"] .status-warning {
    background: rgba(245, 158, 11, 0.25) !important;
    color: rgba(251, 191, 36, 0.95) !important;
    border: 1px solid rgba(251, 191, 36, 0.4) !important;
}

[data-theme="dark"] .status-error,
[data-theme="dark"] .status-offline {
    background: rgba(239, 68, 68, 0.25) !important;
    color: rgba(248, 113, 113, 0.95) !important;
    border: 1px solid rgba(248, 113, 113, 0.4) !important;
}

/* Enhanced button visibility with dynamic theming */
.btn,
.button,
button {
    transition: all 0.2s ease !important;
    border-radius: 8px !important;
    font-weight: 500 !important;
    cursor: pointer !important;
}

.btn-primary,
.button-primary,
.primary-btn {
    background: var(--primary-500) !important;
    color: white !important;
    border: 1px solid var(--primary-500) !important;
}

.btn-primary:hover,
.button-primary:hover,
.primary-btn:hover {
    background: var(--primary-600) !important;
    border-color: var(--primary-600) !important;
    transform: translateY(-1px) !important;
}

/* Secondary buttons */
.btn-secondary,
.button-secondary,
.secondary-btn {
    background: transparent !important;
    color: var(--primary-500) !important;
    border: 1px solid var(--primary-500) !important;
}

.btn-secondary:hover,
.button-secondary:hover,
.secondary-btn:hover {
    background: var(--primary-500) !important;
    color: white !important;
}

[data-theme="dark"] .btn-secondary,
[data-theme="dark"] .button-secondary,
[data-theme="dark"] .secondary-btn {
    color: var(--primary-400) !important;
    border-color: var(--primary-400) !important;
}

[data-theme="dark"] .btn-secondary:hover,
[data-theme="dark"] .button-secondary:hover,
[data-theme="dark"] .secondary-btn:hover {
    background: var(--primary-400) !important;
    color: var(--gray-900) !important;
}

/* Text contrast improvements */
.text-muted,
.text-secondary,
.subtitle,
.description {
    color: var(--text-secondary) !important;
}

[data-theme="dark"] .text-muted,
[data-theme="dark"] .text-secondary,
[data-theme="dark"] .subtitle,
[data-theme="dark"] .description {
    color: var(--text-tertiary) !important;
}

/* Ensure all text has sufficient contrast */
p,
span,
div,
label,
li,
td,
th {
    color: var(--text-primary) !important;
}

[data-theme="dark"] p,
[data-theme="dark"] span,
[data-theme="dark"] div,
[data-theme="dark"] label,
[data-theme="dark"] li,
[data-theme="dark"] td,
[data-theme="dark"] th {
    color: rgba(243, 244, 246, 0.95) !important;
}

/* 19. ULTIMATE SIDEBAR LIGHT MODE OVERRIDE */
/* This must be at the end to override any other CSS */
html:not([data-theme="dark"]) .sidebar,
body:not([data-theme="dark"]) .sidebar,
[data-theme="light"] .sidebar,
.sidebar:not([data-theme="dark"]) {
    background: #ffffff !important;
    background-color: #ffffff !important;
    background-image: none !important;
    --bg-elevated: #ffffff !important;
}

/* Force override any theme variables that might affect sidebar */
html:not([data-theme="dark"]) {
    --sidebar-bg: #ffffff !important;
}

/* Additional specificity for any stubborn elements in sidebar - handled above */